import IP
import Testing

@Test
func Masking() throws
{
    let x:IP.V6 = .init(
        0x0123,
        0x2345,
        0x3456,
        0x4567,
        0x5678,
        0x6789,
        0x789a,
        0x89ab)

    #expect(x / 0 == .zero)
    #expect(x / 1 == .init(0x0000, 0, 0, 0, 0, 0, 0, 0))
    #expect(x / 8 == .init(0x0100, 0, 0, 0, 0, 0, 0, 0))
    #expect(x / 16 == .init(0x0123, 0, 0, 0, 0, 0, 0, 0))
    #expect(x / 32 == .init(0x0123, 0x2345, 0, 0, 0, 0, 0, 0))
    #expect(x / 60 == .init(0x0123, 0x2345, 0x3456, 0x4560, 0, 0, 0, 0))
    #expect(x / 64 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0, 0, 0, 0))
    #expect(x / 68 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5000, 0, 0, 0))
    #expect(x / 96 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0, 0))
    #expect(x / 112 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0))
    #expect(x / 120 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0x8900))
    #expect(x / 127 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0x89aa))
    #expect(x / 128 == x)

    #expect(x ^ 0 == .ones)
    #expect(x ^ 1 == .init(0x7fff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 8 == .init(0x01ff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 16 == .init(0x0123, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 32 == .init(0x0123, 0x2345, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 60 == .init(0x0123, 0x2345, 0x3456, 0x456f, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 64 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0xffff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 68 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5fff, 0xffff, 0xffff, 0xffff))
    #expect(x ^ 96 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0xffff, 0xffff))
    #expect(x ^ 112 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0xffff))
    #expect(x ^ 120 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0x89ff))
    #expect(x ^ 127 == .init(0x0123, 0x2345, 0x3456, 0x4567, 0x5678, 0x6789, 0x789a, 0x89ab))
    #expect(x ^ 128 == x)
}
